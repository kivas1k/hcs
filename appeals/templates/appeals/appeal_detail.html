{% extends "base.html" %}

{% block title %}–û–±—Ä–∞—â–µ–Ω–∏–µ #{{ appeal.id }} ‚Äî –ñ–ö–• –°–µ—Ä–≤–∏—Å{% endblock %}

{% block content %}
<div class="auth-form">
  {% if messages %}
  <div class="alert alert-success">
    <span class="alert-icon">‚úÖ</span>
    <div class="alert-content">
      {% for message in messages %}
        {{ message }}
      {% endfor %}
    </div>
    <a href="{% url 'appeals:my_appeals' %}" class="btn btn-outline">
      ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É
    </a>
  </div>
  {% endif %}

  <div class="appeal-header">
    <h2>–û–±—Ä–∞—â–µ–Ω–∏–µ #{{ appeal.id }}</h2>
    <span class="status-badge {{ appeal.status }}">{{ appeal.get_status_display }}</span>
  </div>

  <div class="appeal-details">
    <div class="detail-item">
      <label>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</span>
          <span class="info-value">{{ appeal.created_at|date:"d.m.Y H:i" }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</span>
          <span class="info-value">{{ appeal.get_priority_display }}</span>
        </div>
      </div>
    </div>

    <div class="detail-item">
      <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
      <p class="appeal-title">{{ appeal.title }}</p>
    </div>

    <div class="detail-item">
      <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
      <div class="appeal-description">
        {{ appeal.description|linebreaks }}
      </div>
    </div>

    {% if documents %}
    <div class="detail-item">
      <label>üìé –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</label>
      <div class="document-list">
        {% for document in documents %}
          <div class="document-item">
            <a href="{{ document.file.url }}" target="_blank" class="document-link">
              {{ document.file.name|slice:"15:"|truncatechars:30 }}
            </a>
            <span class="document-size">{{ document.file.size|filesizeformat }}</span>
          </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>

  <div class="form-actions">
    {% if appeal.author == request.user and appeal.status != 'completed' %}
      <a href="{% url 'appeals:edit_appeal' appeal.id %}" class="btn btn-primary">
        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
      </a>
      <form method="post" action="{% url 'appeals:delete_appeal' appeal.id %}" class="delete-form">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger"
                onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ?')">
          üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
        </button>
      </form>
    {% endif %}
    <a href="{% url 'appeals:my_appeals' %}" class="btn btn-outline">
      ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
    </a>
  </div>
</div>
{% endblock %}