{% extends "base.html" %}

{% block title %}–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è ‚Äî –ñ–ö–• –°–µ—Ä–≤–∏—Å{% endblock %}

{% block content %}
<div class="auth-form create-appeal">
  <h2>–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è</h2>
  <form method="post" enctype="multipart/form-data" class="appeal-form">
    {% csrf_token %}

    {% if form.non_field_errors %}
    <div class="errorlist">
      {% for error in form.non_field_errors %}
        {{ error }}
      {% endfor %}
    </div>
    {% endif %}

    <div class="form-group card-style">
      <label for="{{ form.title.id_for_label }}">
        –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏—è
        <span class="required">*</span>
      </label>
      {{ form.title }}
      {{ form.title.errors }}
    </div>

    <div class="form-group card-style">
      <label for="{{ form.description.id_for_label }}">
        –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
        <span class="required">*</span>
      </label>
      {{ form.description }}
      {{ form.description.errors }}
    </div>

    <div class="form-group card-style">
      <label>üè∑ –¢–µ–≥–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</label>
      <div class="tags-container">
        {% for checkbox in form.tags %}
          <label class="tag-button">
            {{ checkbox.tag }}
            <span class="custom-checkbox"></span>
            <span class="tag-label">{{ checkbox.choice_label }}</span>
          </label>
        {% endfor %}
      </div>
      {{ form.tags.errors }}
    </div>

    <div class="form-group card-style file-upload">
      <label>
        üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã
        <div class="upload-area">
          <svg width="40" height="40" viewBox="0 0 24 24" class="upload-icon">
            <path fill="var(--primary)" d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/>
            <path fill="var(--primary)" d="M16 13h-3V10h-2v3H8l4 4 4-4z"/>
          </svg>
          <span class="upload-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</span>
          <input type="file" name="files" multiple class="file-input">
        </div>
      </label>
      {{ document_form.files.errors }}
    </div>

    <button type="submit" class="btn btn-primary submit-btn">
      –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ
      <svg width="20" height="20" viewBox="0 0 24 24" class="submit-icon">
        <path fill="currentColor" d="M2 21v-2h20v2H2zm3.9-4.8-1.4-1.4L12 6l7.5 7.8-1.4 1.4L12 9 5.9 16.2z"/>
      </svg>
    </button>
  </form>
</div>

<style>
.tags-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 8px 0;
}

.tag-button {
  display: inline-flex;
  align-items: center;
  padding: 8px 16px;
  border: 2px solid #e0f5eb;
  border-radius: 20px;
  background: #f8fffb;
  cursor: pointer;
  transition: all 0.2s;
  user-select: none;
  position: relative;
}

.tag-button:hover {
  background: #e0f5eb;
}

.tag-button.active {
  background: var(--primary);
  border-color: var(--primary);
  color: white;
}

.tag-button input[type="checkbox"] {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.custom-checkbox {
  width: 18px;
  height: 18px;
  border: 2px solid var(--primary);
  border-radius: 4px;
  margin-right: 8px;
  transition: all 0.2s;
}

.tag-button.active .custom-checkbox {
  border-color: white;
  background: white;
}

.tag-button.active .custom-checkbox::after {
  content: '‚úì';
  position: absolute;
  left: 3px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--primary);
  font-size: 14px;
}

.tag-label {
  font-weight: 500;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.tag-button').forEach(button => {
    const checkbox = button.querySelector('input[type="checkbox"]');
    if(checkbox.checked) {
      button.classList.add('active');
    }
  });

  document.querySelectorAll('.tag-button').forEach(button => {
    button.addEventListener('click', function(e) {
      const checkbox = this.querySelector('input[type="checkbox"]');
      checkbox.checked = !checkbox.checked;
      this.classList.toggle('active', checkbox.checked);

      const event = new Event('change', { bubbles: true });
      checkbox.dispatchEvent(event);
    });
  });
});
</script>
{% endblock %}